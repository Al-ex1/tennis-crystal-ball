<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<!--@thymesVar id="timeline" type="org.strangeforest.tcb.stats.model.BigGunsTimeline"-->
<!--@thymesVar id="minGOATPoints" type="java.lang.Integer"-->
<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>
	<title>Ultimate Tennis Statistics - Big Guns Timeline</title>
	<link th:href="@{/webjars/bootstrap/3.3.6/css/bootstrap.min.css}" rel="stylesheet" media="screen"/>
	<link th:href="@{/webjars/jquery-ui-themes/1.11.4/smoothness/jquery-ui.css}" rel="stylesheet" media="screen"/>
	<link th:href="@{/webjars/jquery.bootgrid/1.2.0/dist/jquery.bootgrid.min.css}" rel="stylesheet" media="screen"/>
	<link th:href="@{/css/tennis-stats.css}" rel="stylesheet" media="screen"/>
	<script th:src="@{/webjars/jquery/2.1.4/jquery.min.js}"></script>
	<script th:src="@{/webjars/jquery-ui/1.11.4/jquery-ui.min.js}"></script>
	<script th:src="@{/webjars/bootstrap/3.3.6/js/bootstrap.min.js}"></script>
	<script th:src="@{/webjars/jquery.bootgrid/1.2.0/dist/jquery.bootgrid.min.js}"></script>
	<script th:src="@{/js/tcbUtil.js}"></script>
	<script th:src="@{/js/formatters.js}"></script>
	<script th:src="@{/js/jquery.resize.js}"></script>
	<script type="text/javascript">
		/*<![CDATA[*/
		function correctInitPositions() {
			var $timelineHeader = $("#timelineHeader");
			$timelineHeader.find("span.best-player").each(function() {
				var $bestPlayer = $(this);
				$bestPlayer.css({position: "absolute", display: "block"});
				$bestPlayer.css({top: ($bestPlayer.offset().top - 62) + "px"});
			});
			$timelineHeader.find("span.era-player").each(function() {
				var $eraPlayer = $(this);
				$eraPlayer.css({left: ($eraPlayer.offset().left + $eraPlayer.parent().width() / 2 + 8) + "px"});
			});
			$timelineHeader.find("span.era-factor").each(function() {
				var $eraFactor = $(this);
				$eraFactor.css({position: "absolute", display: "block"});
				$eraFactor.css({
					left: ($eraFactor.offset().left + $eraFactor.parent().width() / 2 - 9) + "px",
					top: ($eraFactor.offset().top - 29) + "px"
				});
			});
		}
		function correctPositionsOnResize() {
			var newOffset = $("#bigGunsTable").offset();
			var dLeft = newOffset.left - bigGunsTableOffset.left;
			var dTop = newOffset.top - bigGunsTableOffset.top;
			correctPosOnResize("span.best-player", dLeft + 20, dTop - 20);
			correctPosOnResize("span.era-factor", dLeft + 2.5, dTop - 2.5);
			bigGunsTableOffset = newOffset;
		}
		function correctPosOnResize(selector, dLeft, dTop) {
			$("#timelineHeader").find(selector).each(function() {
				var $this = $(this);
				var offset = $this.offset();
				$this.css({
					left: (offset.left + dLeft) + "px",
					top: (offset.top + dTop) + "px"
				});
			});
		}
		var bigGunsTableOffset;
		$(function() {
			correctInitPositions();
			bigGunsTableOffset = $("#bigGunsTable").offset();
			$(window).resize(correctPositionsOnResize);
			$("#navbar").resize(correctPositionsOnResize);
		});
		/*]]>*/
	</script>
	<style>
		.container {
			width: 1600px;
		}
		#bigGunsTable > thead > tr.season > th {
			line-height: 2.5;
		}
		#bigGunsTable > thead > tr.best-player > th {
			line-height: 5.0;
		}
		#bigGunsTable > tbody > tr > th,
		#bigGunsTable > tbody > tr > td {
			line-height: 1.0;
			vertical-align: middle;
		}
		span.best-player {
			transform: rotate(-90deg);
			display: none;
			width: 20px;
			height: 60px;
		}
		span.era-factor {
			transform: rotate(-90deg);
			display: none;
			width: 20px;
			height: 25px;
		}
		span.season {
			transform: rotate(-90deg);
			display: block;
			width: 20px;
			height: 25px;
		}
		.points-0, .points-10, .points-20, .points-30, .points-40, .points-50, .points-60, .points-70, .points-80, .points-90, .points-100 {
			text-align: right;
		}
		.points-10 {
			background-color: #ffe8f0;
		}
		.points-20 {
			background-color: #fcd0e0;
		}
		.points-30 {
			background-color: #f8b8d0;
		}
		.points-40 {
			background-color: #f4a0c0;
		}
		.points-50 {
			background-color: #f088b0;
		}
		.points-60 {
			background-color: #ec70a0;
		}
		.points-70 {
			background-color: #e85890;
		}
		.points-80 {
			background-color: #e44080;
		}
		.points-90 {
			background-color: #e02870;
		}
		.points-100 {
			background-color: #dc1060;
		}
		.points {
			color: darkblue;
		}
	</style>
</head>
<body class="container">
	<div th:include="fragments/header :: title"></div>
	<h3>Big Guns Timeline</h3>
	<table id="bigGunsTable" class="table table-condensed table-hover table-bordered text-nowrap">
		<thead id="timelineHeader">
			<tr class="best-player">
				<th colspan="3" style="padding: 1px 4px; text-align: right; border-right: 3px solid lightgray">Era</th>
				<th th:each="era : ${timeline.bigGunsEras}" th:class="'points-' + ${era.dominanceRatioRounded}" style="padding: 1px" th:colspan="${era.seasonCount}">
					<span th:text="${era.player.lastName}" class="best-player era-player">Sampras</span>
				</th>
			</tr>
			<tr class="season">
				<th colspan="3" style="padding: 1px 4px; text-align: right; border-right: 3px solid lightgray">Era Dominance Ratio</th>
				<th th:each="era : ${timeline.bigGunsEras}" th:class="'points-' + ${era.dominanceRatioRounded}" style="padding: 1px" th:colspan="${era.seasonCount}">
					<span th:text="${#numbers.formatDecimal(era.dominanceRatio, 1, 1)}" class="era-factor">66.7</span>
				</th>
			</tr>
			<tr class="best-player">
				<th colspan="3" style="padding: 1px 4px; text-align: right; border-right: 3px solid lightgray">Season Best Player</th>
				<th th:each="season : ${timeline.bigGunsSeasons}" th:class="'points-' + ${season.dominanceRatioRounded}" style="padding: 1px">
					<span th:text="${season.bestPlayer.lastName}" class="best-player">Federer</span>
				</th>
			</tr>
			<tr class="season">
				<th colspan="3" style="padding: 1px 4px; text-align: right; border-right: 3px solid lightgray">Big Guns Dominance Ratio</th>
				<th th:each="season : ${timeline.bigGunsSeasons}" th:class="'points-' + ${season.dominanceRatioRounded}" style="padding: 1px">
					<span th:text="${#numbers.formatDecimal(season.dominanceRatio, 1, 1)}" class="season">66.7</span>
				</th>
			</tr>
			<tr class="season" style="border-bottom: 3px solid lightgray">
				<th style="padding: 1px 4px">Player</th>
				<th style="padding: 1px 4px">Born</th>
				<th style="padding: 1px 4px; border-right: 3px solid lightgray">GOAT Pts.</th>
				<th style="padding: 1px" th:each="season : ${timeline.seasons}"><span th:text="${season}" class="season">2015</span></th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="player : ${timeline.players}">
				<td style="padding: 1px 4px">
					<img th:src="'/images/flags/' + ${player.countryCode} + '.png'" src="/images/flags/ch.png'" th:title="${player.countryId}" title="SUI" width="24" height="20"/>
					<a th:href="'/playerProfile?playerId=' + ${player.playerId}" th:text="${player.name}" style="vertical-align: middle" title="Show profile">Roger Federer</a>
				</td>
				<td style="padding: 1px 4px" th:text="${#dates.format(player.dob, 'yyyy')}">1985</td>
				<td style="padding: 1px 20px; text-align: right; border-right: 3px solid lightgray" th:text="${player.goatPoints}">1985</td>
				<td th:each="seasonPoint : ${player.getSeasonsPoints()}" th:class="'points-' + ${10*(seasonPoint.points/10)}" class="points-10"><a th:href="'playerProfile?playerId=' + ${player.playerId} + '&amp;season=' + ${seasonPoint.season}" th:text="${seasonPoint.points > 0 ? seasonPoint.points : ''}" class="points">15</a></td>
			</tr>
		</tbody>
		<thead>
			<tr class="season" style="border-top: 3px solid lightgray">
				<th style="padding: 1px 4px">Player</th>
				<th style="padding: 1px 4px">Born</th>
				<th style="padding: 1px 4px; border-right: 3px solid lightgray">GOAT Pts.</th>
				<th style="padding: 1px" th:each="season : ${timeline.seasons}"><span th:text="${season}" class="season">2015</span></th>
			</tr>
		</thead>
	</table>
	<p><i>* Minimum <span th:text="${minGOATPoints}">50</span> GOAT points</i></p>
	<div th:include="fragments/goatLegend :: legend"></div>
	<div th:include="fragments/footer :: copy"></div>
</body>
</html>