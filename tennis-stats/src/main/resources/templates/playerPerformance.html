<th:block  xmlns:th="http://www.thymeleaf.org">
<!--/*@thymesVar id="playerId" type="java.lang.Integer"*/-->
<!--/*@thymesVar id="seasons" type="java.util.List<java.lang.Integer>"*/-->
<!--/*@thymesVar id="season" type="java.lang.Integer"*/-->
<!--/*@thymesVar id="rawData" type="java.lang.Boolean"*/-->
<!--/*@thymesVar id="perf" type="org.strangeforest.tcb.stats.model.PlayerPerformanceEx"*/-->
<script type="text/javascript">
	var perfRawData = [(${rawData})];
	$(function() {
		$("#playerPerformance").find(perfRawData ? ".pct-data" : ".raw-data").hide();
		$("#playerPerfSurface").find("div.progress-bar").each(function() {
			var $progressBar = $(this);
			var surface = $progressBar.data("surface");
			$progressBar.addClass("progress-bar-" + surfaceClassSuffix(surface));
		});
	});
	function reloadPerformance() {
		var url = "/playerPerformance?playerId=[(${playerId})]";
		url += "&season=" + $("#perfSeason").val();
		url += "&rawData=" + perfRawData;
		$("#performance").load(url);
	}
</script>
<style scoped="scoped">
	.progress-perf {
		background-color: #dddddd;
		margin-bottom: 0;
	}
	.progress-bar > a {
		color: white;
	}
</style>
<br/>
<div class="row">
	<div class="col-md-4">
		<div class="input-group">
			<label for="perfSeason" class="input-group-addon">Season:</label>
			<select id="perfSeason" class="form-control" onchange="reloadPerformance()">
				<option value="">All seasons</option>
				<option th:each="aSeason : ${seasons}" th:value="${aSeason}" value="2005" th:text="${aSeason}" th:selected="${aSeason == season}">2005</option>
			</select>
		</div>
	</div>
</div>
<br/>
<div id="playerPerformance">
	<div th:unless="${perf.empty}" class="text-nowrap">
		<div class="row">
			<div class="col-lg-4 col-sm-6">
				<table id="playerPerfSurface" class="table table-condensed table-striped">
					<tr>
						<th width="40%">Overall</th>
						<th th:with="wl=${perf.matches}">
							<div th:unless="${wl.empty}" class="progress progress-perf">
								<div class="progress-bar progress-bar-overall" role="progressbar" th:style="'width: ' + ${wl.wonPctStr}" th:attr="aria-valuenow=${wl.wonPct}" aria-valuemin="0" aria-valuemax="100">
									<a th:href="@{/playerProfile(playerId=${playerId}, tab=matches, season=${season}, outcome=played)}" title="Show matches">
										<span class="pct-data" th:text="${wl.pctWL}">50% (10-10)</span>
										<span class="raw-data" th:text="${wl.WLT}">10 - 10 / 20</span>
									</a>
								</div>
							</div>
						</th>
					</tr>
					<tr>
						<th colspan="2">&nbsp;</th>
					</tr>
					<tr>
						<th colspan="2">Surface Breakdown</th>
					</tr>
					<tr th:each="surfaceWL : ${perf.surfaceMatches}" th:with="surface=${surfaceWL.key}, wl=${surfaceWL.value}">
						<td th:text="${surface.text}">Hard</td>
						<th>
							<div class="progress progress-perf">
								<div class="progress-bar progress-bar-perf" th:data-surface="${surface.code}" role="progressbar" th:style="'width: ' + ${wl.wonPctStr}" th:attr="aria-valuenow=${wl.wonPct}" aria-valuemin="0" aria-valuemax="100">
									<a th:href="@{/playerProfile(playerId=${playerId}, tab=matches, season=${season}, surface=${surface.code}, outcome=played)}" th:title="|Show ${surface.text} matches|">
										<span class="pct-data" th:text="${wl.pctWL}">50% (10-10)</span>
										<span class="raw-data" th:text="${wl.WLT}">10 - 10 / 20</span>
									</a>
								</div>
							</div>
						</th>
					</tr>
				</table>
			</div>
			<div class="col-lg-4 col-sm-6">
				<table class="table table-condensed table-striped">
					<tr>
						<th colspan="2">Tournament Level Breakdown</th>
					</tr>
					<tr th:each="levelWL : ${perf.levelMatches}" th:with="level=${levelWL.key}, wl=${levelWL.value}">
						<td width="40%" th:text="${level.text}">Grand Slam</td>
						<th>
							<div class="progress progress-perf">
								<div class="progress-bar progress-bar-perf label-" th:attrappend="class=${level.code}" role="progressbar" th:style="'width: ' + ${wl.wonPctStr}" th:attr="aria-valuenow=${wl.wonPct}" aria-valuemin="0" aria-valuemax="100">
									<a th:href="@{/playerProfile(playerId=${playerId}, tab=matches, season=${season}, level=${level.code}, outcome=played)}" th:title="|Show ${level.text} matches|">
										<span class="pct-data" th:text="${wl.pctWL}">50% (10-10)</span>
										<span class="raw-data" th:text="${wl.WLT}">10 - 10 / 20</span>
									</a>
								</div>
							</div>
						</th>
					</tr>
				</table>
			</div>
		</div>
		<div class="row">
			<div class="col-lg-4 col-sm-6">
				<table class="table table-condensed table-striped">
					<tr>
						<th colspan="2">Opposition Breakdown</th>
					</tr>
					<tr th:each="oppositionWL : ${perf.oppositionMatches}" th:with="opposition=${oppositionWL.key}, wl=${oppositionWL.value}">
						<td width="40%" th:text="${opposition.text}">Vs No. 1</td>
						<th>
							<div class="progress progress-perf">
								<div class="progress-bar progress-bar-perf-def" role="progressbar" th:style="'width: ' + ${wl.wonPctStr}" th:attr="aria-valuenow=${wl.wonPct}" aria-valuemin="0" aria-valuemax="100">
									<a th:href="@{/playerProfile(playerId=${playerId}, tab=matches, season=${season}, opponent=${opposition}, outcome=played)}" th:title="|Show ${opposition.text} matches|">
										<span class="pct-data" th:text="${wl.pctWL}">50% (10-10)</span>
										<span class="raw-data" th:text="${wl.WLT}">10 - 10 / 20</span>
									</a>
								</div>
							</div>
						</th>
					</tr>
				</table>
			</div>
			<div class="col-lg-4 col-sm-6">
				<table class="table table-condensed table-striped">
					<tr>
						<th colspan="2">Round Breakdown</th>
					</tr>
					<tr th:each="roundWL : ${perf.roundMatches}" th:with="round=${roundWL.key}, wl=${roundWL.value}">
						<td width="40%" th:text="${round.text}">Final</td>
						<th>
							<div class="progress progress-perf">
								<div class="progress-bar progress-bar-perf-def" role="progressbar" th:style="'width: ' + ${wl.wonPctStr}" th:attr="aria-valuenow=${wl.wonPct}" aria-valuemin="0" aria-valuemax="100">
									<a th:href="@{/playerProfile(playerId=${playerId}, tab=matches, season=${season}, round=${round.code}, level=GFMOAB, outcome=played)}" th:title="|Show ${round.text} matches|">
										<span class="pct-data" th:text="${wl.pctWL}">50% (10-10)</span>
										<span class="raw-data" th:text="${wl.WLT}">10 - 10 / 20</span>
									</a>
								</div>
							</div>
						</th>
					</tr>
				</table>
			</div>
			<div class="col-lg-4 col-sm-6">
				<table class="table table-condensed table-striped">
					<tr>
						<th colspan="2">Pressure Situations</th>
					</tr>
					<tr>
						<td width="40%">Deciding Set</td>
						<th th:with="wl=${perf.decidingSets}">
							<div th:unless="${wl.empty}" class="progress progress-perf">
								<div class="progress-bar progress-bar-perf-def" role="progressbar" th:style="'width: ' + ${wl.wonPctStr}" th:attr="aria-valuenow=${wl.wonPct}" aria-valuemin="0" aria-valuemax="100">
									<span class="pct-data" th:text="${wl.pctWL}">50% (10-10)</span>
									<span class="raw-data" th:text="${wl.WLT}">10 - 10 / 20</span>
								</div>
							</div>
						</th>
					</tr>
					<tr>
						<td>Fifth Set</td>
						<th th:with="wl=${perf.fifthSets}">
							<div th:unless="${wl.empty}" class="progress progress-perf">
								<div class="progress-bar progress-bar-perf-def" role="progressbar" th:style="'width: ' + ${wl.wonPctStr}" th:attr="aria-valuenow=${wl.wonPct}" aria-valuemin="0" aria-valuemax="100">
									<a th:href="@{/playerProfile(playerId=${playerId}, tab=matches, season=${season}, score='2:2+', outcome=played)}" title="Show fifth set matches">
										<span class="pct-data" th:text="${wl.pctWL}">50% (10-10)</span>
										<span class="raw-data" th:text="${wl.WLT}">10 - 10 / 20</span>
									</a>
								</div>
							</div>
						</th>
					</tr>
					<tr>
						<td>After Winning 1st Set</td>
						<th th:with="wl=${perf.afterWinningFirstSet}">
							<div th:unless="${wl.empty}" class="progress progress-perf">
								<div class="progress-bar progress-bar-perf-def" role="progressbar" th:style="'width: ' + ${wl.wonPctStr}" th:attr="aria-valuenow=${wl.wonPct}" aria-valuemin="0" aria-valuemax="100">
									<a th:href="@{/playerProfile(playerId=${playerId}, tab=matches, season=${season}, score='1:0+', outcome=played)}" title="Show after winning 1st set matches">
										<span class="pct-data" th:text="${wl.pctWL}">50% (10-10)</span>
										<span class="raw-data" th:text="${wl.WLT}">10 - 10 / 20</span>
									</a>
								</div>
							</div>
						</th>
					</tr>
					<tr>
						<td>After Losing 1st Set</td>
						<th th:with="wl=${perf.afterLosingFirstSet}">
							<div th:unless="${wl.empty}" class="progress progress-perf">
								<div class="progress-bar progress-bar-perf-def" role="progressbar" th:style="'width: ' + ${wl.wonPctStr}" th:attr="aria-valuenow=${wl.wonPct}" aria-valuemin="0" aria-valuemax="100">
									<a th:href="@{/playerProfile(playerId=${playerId}, tab=matches, season=${season}, score='0:1+', outcome=played)}" title="Show after losing 1st set matches">
										<span class="pct-data" th:text="${wl.pctWL}">50% (10-10)</span>
										<span class="raw-data" th:text="${wl.WLT}">10 - 10 / 20</span>
									</a>
								</div>
							</div>
						</th>
					</tr>
					<tr>
						<td>Tie Breaks</td>
						<th th:with="wl=${perf.tieBreaks}">
							<div th:unless="${wl.empty}" class="progress progress-perf">
								<div class="progress-bar progress-bar-perf-def" role="progressbar" th:style="'width: ' + ${wl.wonPctStr}" th:attr="aria-valuenow=${wl.wonPct}" aria-valuemin="0" aria-valuemax="100">
									<span class="pct-data" th:text="${wl.pctWL}">50% (10-10)</span>
									<span class="raw-data" th:text="${wl.WLT}">10 - 10 / 20</span>
								</div>
							</div>
						</th>
					</tr>
				</table>
			</div>
		</div>
	</div>
	<div th:unless="${perf.empty}" class="row">
		<div class="pct-data col-md-3">
			<button class="btn btn-default btn-xs" onclick="toggleStatsData('#playerPerformance'); perfRawData = true" title="Show raw data: Won - Lost / Played"><span class="glyphicon glyphicon-equalizer"></span>&nbsp;&nbsp;Raw Data</button>
		</div>
		<div class="raw-data col-md-3">
			<button class="btn btn-default btn-xs" onclick="toggleStatsData('#playerPerformance'); perfRawData = false" title="Show percentage data: Pct. (Won-Lost)"><span class="glyphicon glyphicon-tasks"></span>&nbsp;&nbsp;Pct. Data</button>
		</div>
	</div>
	<th:block th:if="${perf.empty}"><p>No performance data available</p></th:block>
</div>
</th:block>